(function(){"use strict";var e={7506:function(e,t,s){var a=s(144),r=s(998),o=s(6232),i=s(3423),n=s(6190),l=s(2118),c=s(5808),u=s(4525),m=s(6098),d=s(3059),h=s(4528),p=s(9258),f=s(3687),b=s(7953),v=(s(7658),function(){var e=this,t=e._self._c;return t(r.Z,[t(o.Z,{attrs:{app:"",color:"green",dark:""}},[t(b.qW,{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$router.push("/")}}},[e._v(e._s(e.appName))]),t(f.Z),e.loginStatus?t(b.lj,[t(h.Z,{attrs:{"offset-y":"","open-on-hover":""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(n.Z,e._g({staticStyle:{cursor:"default"},attrs:{text:""}},s),[t(i.Z,{staticClass:"mr-3",attrs:{size:"40"}},[t("img",{attrs:{src:e.userIcon}})]),e._v(e._s(e.userName))],1)]}}],null,!1,4007436275)},[t(c.Z,[t(u.Z,{attrs:{link:""}},[t(m.km,[t(m.V9,{on:{click:e.logout}},[e._v("ログアウト")])],1)],1)],1)],1),t(h.Z,{attrs:{"offset-y":"","open-on-hover":""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(n.Z,e._g({staticStyle:{cursor:"default"},attrs:{text:""}},s),[e._v("設定")])]}}],null,!1,2185790517)},[t(c.Z,[t(u.Z,{attrs:{link:"",to:"/admins"}},[t(m.km,[t(m.V9,[e._v("管理者設定")])],1)],1),t(u.Z,{attrs:{link:"",to:"/departments"}},[t(m.km,[t(m.V9,[e._v("部署設定")])],1)],1),t(u.Z,{attrs:{link:"",to:"/users"}},[t(m.km,[t(m.V9,[e._v("従業員設定")])],1)],1),t(u.Z,{attrs:{link:"",to:"/routes"}},[t(m.km,[t(m.V9,[e._v("申請ルート設定")])],1)],1),t(u.Z,{attrs:{link:"",to:"/settings"}},[t(m.km,[t(m.V9,[e._v("アプリ設定")])],1)],1),t(u.Z,{attrs:{link:"",to:"/test"}},[t(m.km,[t(m.V9,[e._v("テスト")])],1)],1)],1)],1)],1):e._e()],1),t(d.Z,[t(l.Z,{attrs:{fluid:""}},[t("router-view")],1)],1),t(p.Z,{attrs:{color:"info"},scopedSlots:e._u([{key:"action",fn:function({attrs:s}){return[t(n.Z,e._b({attrs:{text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",s,!1),[e._v("Close")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.message)+" ")])],1)}),g=[],k=s(629),y={name:"App",data(){return{snackbar:!1,message:""}},computed:{...(0,k.rn)({appName:e=>e.workflow.settings.appName,authMessage:e=>e.firebase.authMessage,workflowMessage:e=>e.firestore.workflowMessage}),...(0,k.Se)({userName:"firebase/getUserName",userIcon:"firebase/getUserIcon",loginStatus:"firebase/getLoginStatus"})},beforeCreate(){this.$store.dispatch("workflow/loadSettings")},methods:{async logout(){await this.$store.dispatch("firebase/logout")}},watch:{authMessage(){this.message=this.authMessage,this.snackbar=!0},workflowMessage(){this.message=this.workflowMessage,this.snackbar=!0}}},Z=y,T=s(1001),w=(0,T.Z)(Z,v,g,!1,null,null,null),x=w.exports,_=s(8345),D=s(7263),C=s(9582),I=s(4886),N=s(266),R=s(1713),A=function(){var e=this,t=e._self._c;return t(R.Z,{attrs:{justify:"center"}},[t(N.Z,{attrs:{cols:"12",sm:"12",md:"4"}},[t(C.Z,{attrs:{height:"200px"}},[t(I.EB,{staticClass:"justify-center",attrs:{"mb-3":""}},[t("h1",{staticClass:"display-1"},[e._v("ログイン")])]),t(I.h7,{staticClass:"justify-center"},[t(n.Z,{staticStyle:{"text-transform":"none"},attrs:{width:"80%"},on:{click:e.loginWithGoogle}},[t("svg",{staticClass:"mr-3",attrs:{width:"18",height:"18",viewBox:"0 0 18 18"}},[t("path",{attrs:{d:"M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 002.38-5.88c0-.57-.05-.66-.15-1.18z",fill:"#4285F4"}}),t("path",{attrs:{d:"M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 01-7.18-2.54H1.83v2.07A8 8 0 008.98 17z",fill:"#34A853"}}),t("path",{attrs:{d:"M4.5 10.52a4.8 4.8 0 010-3.04V5.41H1.83a8 8 0 000 7.18l2.67-2.07z",fill:"#FBBC05"}}),t("path",{attrs:{d:"M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 001.83 5.4L4.5 7.49a4.77 4.77 0 014.48-3.3z",fill:"#EA4335"}})]),e._v(" Login with Google ")])],1)],1)],1)],1)},S=[],q={name:"Login",data(){return{redirect:null}},methods:{async loginWithGoogle(){this.redirect=this.$route.query.redirect,await this.$store.dispatch("firebase/login"),this.redirect?this.$router.push(this.redirect):this.$router.push("/")}}},U=q,E=(0,T.Z)(U,A,S,!1,null,null,null),$=E.exports,P=s(5125),O=s(7808),B=function(){var e=this,t=e._self._c;return t("div",{staticClass:"form-wrapper"},[t("p",[e._v("※設定はこのデバイスのみに保存されます。")]),t(P.Z,{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t("h3",[e._v("アプリ設定")]),t(O.Z,{attrs:{label:"アプリ名",counter:30,rules:[e.appNameRule]},model:{value:e.settings.appName,callback:function(t){e.$set(e.settings,"appName",t)},expression:"settings.appName"}}),t(O.Z,{attrs:{label:"API URL",counter:150,rules:[e.stringRule]},model:{value:e.settings.apiUrl,callback:function(t){e.$set(e.settings,"apiUrl",t)},expression:"settings.apiUrl"}}),t(O.Z,{attrs:{label:"Auth Token",counter:150,rules:[e.stringRule]},model:{value:e.settings.authToken,callback:function(t){e.$set(e.settings,"authToken",t)},expression:"settings.authToken"}}),t(R.Z,{staticClass:"mt-4"},[t(f.Z),t(n.Z,{attrs:{color:"primary",disabled:!e.valid},on:{click:e.onClickSave}},[e._v("保存")])],1)],1)],1)},M=[],j={name:"Settings",data(){return{settings:{...this.$store.state.workflow.settings},valid:!1,appNameRule:e=>e.length<=30||"30文字以内で入力してください",stringRule:e=>e.length<=150||"150文字以内で入力してください"}},methods:{onClickSave(){this.$store.dispatch("workflow/saveSettings",{settings:this.settings})}}},H=j,J=(0,T.Z)(H,B,M,!1,null,null,null),W=J.exports,L=s(1154),Y=s(4127),F=s(3863),Q=s(4324),V=s(626),z=s(2769),G=function(){var e=this,t=e._self._c;return t("div",[t(R.Z,[t(N.Z,{attrs:{cols:"12",md:"6",xs:"12"}},[t(z.Z,{attrs:{grow:"",color:"green"}},[t(V.Z,{on:{click:function(t){return e.onClickTab("myRequests")}}},[e._v("自分の申請")]),t(V.Z,{on:{click:function(t){return e.onClickTab("othersRequests")}}},[e.numberOfOthersRequests?[t(L.Z,{attrs:{color:"red",content:e.numberOfOthersRequests}},[e._v("承認依頼")])]:[e._v("承認依頼")]],2)],1)],1)],1),t(C.Z,[t(I.EB,[t(N.Z,{attrs:{cols:"8"}},[t("div",{staticClass:"h5"},[e._v(" "+e._s(e.title)+" ")])]),t(f.Z),t(N.Z,{staticClass:"text-right",attrs:{cols:"4"}},[t(n.Z,{attrs:{dark:"",color:"green"},on:{click:e.onClickAdd}},[t(Q.Z,[e._v("mdi-plus")])],1)],1),t(N.Z,{attrs:{cols:"12"}},[t(O.Z,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),t(F.Z,{staticClass:"text-no-wrap",attrs:{headers:e.tableHeaders,items:e.formattedTableData,search:e.search,"footer-props":e.footerProps,"sort-by":"created_at","sort-desc":!0,"items-per-page":30,"mobile-breakpoint":"0"},on:{"click:row":e.onClickRow},scopedSlots:e._u([{key:"item.status",fn:function({item:s}){return[t(Y.Z,{staticClass:"ma-2",attrs:{color:e.statusColor(s),"text-color":"white"}},[t(Q.Z,{attrs:{left:""}},[e._v(" "+e._s(e.statusIcon(s))+" ")]),e._v(" "+e._s(s.status)+" ")],1)]}}],null,!0)})],1),t("ItemDialogRequests",{ref:"ItemDialogRequests"})],1)},K=[],X=s(9930),ee=s(9223),te=s(9481),se=s(2648),ae=function(){var e=this,t=e._self._c;return t(X.Z,{attrs:{scrollable:"",persistent:"","max-width":"500px",eager:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t(C.Z,[t(I.EB,[e._v(e._s(e.titleText))]),t(ee.Z),t(I.ZB,[t(P.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(te.Z,{attrs:{label:"申請書の種類",items:e.items,rules:e.requestTypeRules},model:{value:e.requestType,callback:function(t){e.requestType=t},expression:"requestType"}}),t(O.Z,{attrs:{label:"タイトル",rules:e.titleRules},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),"paid_leave"==e.requestType?t("div",[t(se.Z,{attrs:{label:"事由",rules:e.reasonRules,rows:"3"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}}),t(se.Z,{attrs:{label:"予定日時",rules:e.dateRules,rows:"3"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),t(O.Z,{attrs:{label:"緊急連絡先",rules:e.contactRules},model:{value:e.contact,callback:function(t){e.contact=t},expression:"contact"}}),t(se.Z,{attrs:{label:"備考",rows:"3"},model:{value:e.memo,callback:function(t){e.memo=t},expression:"memo"}})],1):e._e()],1)],1),t(ee.Z),t(I.h7,[t(f.Z),t(n.Z,{attrs:{color:"grey darken-1",text:""},on:{click:e.onClickClose}},[e._v(" キャンセル ")]),t(n.Z,{attrs:{color:"blue darken-1",text:"",disabled:!e.valid},on:{click:e.onClickAction}},[e._v(" "+e._s(e.actionText)+" ")])],1)],1)],1)},re=[],oe=s(1294),ie=s(7632),ne={name:"ItemDialogRequests",data(){return{items:[{text:"休暇申請",value:"paid_leave"},{text:"備品申請",value:"equipment"}],show:!1,valid:!1,menu:!1,actionType:"add",requestType:"",id:"",title:"",reason:"",date:"",contact:"",memo:"",requestTypeRules:[e=>e.trim().length>0||"申請書の種類は必須です"],titleRules:[e=>e.trim().length>0||"タイトルは必須です"],reasonRules:[e=>e.trim().length>0||"事由は必須です"],dateRules:[e=>e.trim().length>0||"予定日時は必須です"],contactRules:[e=>e.trim().length>0||"緊急連絡先は必須です"]}},computed:{...(0,k.rn)({userInfo:e=>e.firestore.userInfo}),titleText(){return"add"===this.actionType?"データ追加":"データ編集"},actionText(){return"add"===this.actionType?"追加":"更新"}},methods:{...(0,k.Se)({getUserEmail:"firebase/getUserEmail",getArrayRoute:"firestore/getArrayRoute"}),...(0,k.nv)({batchAddSubCollectionsToUsers:"firestore/batchAddSubCollectionsToUsers",fetchUserInfo:"firestore/fetchUserInfo",createArrayRoute:"firestore/createArrayRoute",sendEmail:"firestore/sendEmail"}),open(e,t){this.show=!0,this.actionType=e,this.resetForm(t)},onClickClose(){this.show=!1},async onClickAction(){if("add"===this.actionType){const e=(0,ie.Z)(),t=this.getUserEmail(),s=this.requestType;await this.fetchUserInfo({userId:t});const a=this.userInfo.department;await this.createArrayRoute({requestType:s,department:a});const r=this.getArrayRoute()[0],o=[];r.approvers.forEach((e=>{o.push({...e,status:"保留中"})})),r.approvers=o;const i=1,n=r.approvers.length,l={request:{title:this.title,status:"保留中",current_approver_email:r.approvers[0].email,created_at:(0,oe.Bt)(),email:this.userInfo.id,name:this.userInfo.name,department:this.userInfo.department},detail:{id:e,title:this.title,status:"保留中",current_approver_email:r.approvers[0].email,created_at:(0,oe.Bt)(),email:this.userInfo.id,name:this.userInfo.name,department:this.userInfo.department,current_step:i,max_step:n,reason:this.reason,date:this.date,contact:this.contact,memo:this.memo,routes:r,comments:[]}};await this.batchAddSubCollectionsToUsers({uid:e,userId:t,item:l});const c=r.approvers[0].email,u=`申請が提出されました [${this.title}]`,m=`${window.location.href}others/requests/${e}`,d=this.createEmailBody(u,m),h={to:c,subject:u,body:d};await this.sendEmail({emailConfig:h}),this.show=!1}},resetForm(e={}){this.id=e.id||"",this.title=e.title||"",this.reason=e.reason||"",this.date=e.date||"",this.contact=e.contact||"",this.memo=e.memo||"",this.$refs.form.resetValidation()},createEmailBody(e,t){const s=`${e}<br><br>詳細は下記リンクからご確認ください。<br><br><a href="${t}">${t}</a>`;return s}}},le=ne,ce=(0,T.Z)(le,ae,re,!1,null,null,null),ue=ce.exports,me={name:"RequestOverView",components:{ItemDialogRequests:ue},data(){return{currentTableName:"myRequests",title:"申請一覧",search:"",tableData:[]}},computed:{...(0,k.rn)({myRequests:e=>e.firestore.myRequests,othersRequests:e=>e.firestore.othersRequests,selectedTabName:e=>e.firestore.selectedTabName}),formattedTableData(){return this.tableData.map((e=>({...e,created_at:this.dateToStr24HPad0(e.created_at.toDate())})))},tableHeaders(){return[{text:"作成日時",value:"created_at"},{text:"ステータス",value:"status",sortable:!1},{text:"タイトル",value:"title",sortable:!1},{text:"申請者",value:"name",sortable:!1},{text:"部署",value:"department",sortable:!1}]},footerProps(){return{itemsPerPageText:"",itemsPerPageOptions:[30,-1]}},numberOfOthersRequests(){return this.othersRequests.length}},methods:{...(0,k.nv)({fetchMyRequests:"firestore/fetchMyRequests",fetchOthersRequests:"firestore/fetchOthersRequests",setSelectedTabName:"firestore/setSelectedTabName"}),...(0,k.Se)({getUserEmail:"firebase/getUserEmail"}),onClickAdd(){this.$refs.ItemDialogRequests.open("add")},onClickRow(e){switch(this.selectedTabName){case"myRequests":this.$router.push({path:`/my/requests/${e.id}`});break;case"othersRequests":this.$router.push({path:`/others/requests/${e.id}`});break}},async onClickTab(e){this.setSelectedTabName({selectedTabName:e});const t=this.getUserEmail();switch(e){case"myRequests":await this.fetchMyRequests({userId:t}),this.tableData=this.myRequests;break;case"othersRequests":this.tableData=this.othersRequests;break}},dateToStr24HPad0(e,t){return t||(t="YYYY/MM/DD hh:mm"),t=t.replace(/YYYY/g,e.getFullYear()),t=t.replace(/MM/g,("0"+(e.getMonth()+1)).slice(-2)),t=t.replace(/DD/g,("0"+e.getDate()).slice(-2)),t=t.replace(/hh/g,("0"+e.getHours()).slice(-2)),t=t.replace(/mm/g,("0"+e.getMinutes()).slice(-2)),t=t.replace(/ss/g,("0"+e.getSeconds()).slice(-2)),t},statusColor(e){let t="";switch(e.status){case"完了":t="green";break;case"保留中":t="blue";break;case"否認":t="red";break;case"差戻し":t="orange";break}return t},statusIcon(e){let t="";switch(e.status){case"完了":t="mdi-check";break;case"保留中":t="mdi-timer-sand";break;case"否認":t="mdi-cancel";break;case"差戻し":t="mdi-arrow-u-left-bottom";break}return t}},async created(){this.setSelectedTabName({selectedTabName:"myRequests"});const e=this.getUserEmail();await this.fetchMyRequests({userId:e}),await this.fetchOthersRequests({userId:e}),this.tableData=this.myRequests}},de=me,he=(0,T.Z)(de,G,K,!1,null,null,null),pe=he.exports,fe=s(8271),be=s(535),ve=s(1744),ge=s(8491),ke=function(){var e=this,t=e._self._c;return t("div",[t(R.Z,{attrs:{justify:"center"}},[t(N.Z,{attrs:{cols:"12",md:"6",xs:"12"}},[t(C.Z,[e.$vuetify.breakpoint.xs||e.$vuetify.breakpoint.sm?[e.currentStep?t(be.Z,{attrs:{vertical:""},model:{value:e.currentStep,callback:function(t){e.currentStep=t},expression:"currentStep"}},[e._l(e.maxStep,(function(s,a){return[t(ge.Z,{key:`${s}-step`,attrs:{complete:"完了"==e.routes.approvers[a].status,step:s,rules:[()=>{const t=["否認"==e.routes.approvers[a].status,"差戻し"==e.routes.approvers[a].status];return!t.some((e=>1==e))}]}},[e._v(" "+e._s(e.routes.approvers[a].name)+" "),t("small",{staticClass:"mt-2"},[e._v(e._s(e.routes.approvers[a].status))])]),s<e.maxStep?t("div",{key:`${s}-div`,staticStyle:{"border-left":"1px solid rgba(0,0,0,.25)",height:"30px","margin-left":"36px"}}):e._e()]}))],2):e._e()]:[e.currentStep?t(be.Z,{attrs:{"alt-labels":""},model:{value:e.currentStep,callback:function(t){e.currentStep=t},expression:"currentStep"}},[t(ve.Rp,[e._l(e.maxStep,(function(s,a){return[t(ge.Z,{key:`${s}-step`,attrs:{complete:"完了"==e.routes.approvers[a].status,step:s,rules:[()=>{const t=["否認"==e.routes.approvers[a].status,"差戻し"==e.routes.approvers[a].status];return!t.some((e=>1==e))}]}},[e._v(" "+e._s(e.routes.approvers[a].name)+" "),t("small",{staticClass:"mt-2"},[e._v(e._s(e.routes.approvers[a].status))])]),s<e.maxStep?t(ee.Z,{key:`${s}-divider`}):e._e()]}))],2)],1):e._e()]],2)],1)],1),t(R.Z,{attrs:{justify:"center"}},[t(N.Z,{attrs:{cols:"12",md:"6",xs:"12"}},[t(C.Z,[t(I.ZB,[t(P.Z,{attrs:{readonly:""}},[t(O.Z,{attrs:{label:"タイトル"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),t(O.Z,{attrs:{label:"作成日時"},model:{value:e.created_at,callback:function(t){e.created_at=t},expression:"created_at"}}),t(O.Z,{attrs:{label:"申請者"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t(O.Z,{attrs:{label:"メールアドレス"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),t(O.Z,{attrs:{label:"部署"},model:{value:e.department,callback:function(t){e.department=t},expression:"department"}}),t(O.Z,{attrs:{label:"事由"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}}),t(O.Z,{attrs:{label:"予定日時"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),t(O.Z,{attrs:{label:"緊急連絡先"},model:{value:e.contact,callback:function(t){e.contact=t},expression:"contact"}}),t(O.Z,{attrs:{label:"備考"},model:{value:e.memo,callback:function(t){e.memo=t},expression:"memo"}})],1)],1)],1)],1)],1),t(fe.Z,{attrs:{app:"",padless:""}},[t(N.Z,{staticClass:"text-center",attrs:{col:"12"}},[t(n.Z,{staticClass:"mx-2",attrs:{color:"green",dark:!e.isDisabledApproveBtn,disabled:e.isDisabledApproveBtn},on:{click:e.onClickApprove}},[e._v("承認")]),t(n.Z,{staticClass:"mx-2",attrs:{color:"green",dark:!e.isDisabledApproveBtn,disabled:e.isDisabledApproveBtn},on:{click:e.onClickDisapprove}},[e._v("否認")]),t(n.Z,{staticClass:"mx-2",attrs:{color:"green",dark:!e.isDisabledApproveBtn,disabled:e.isDisabledApproveBtn},on:{click:e.onClickRemand}},[e._v("差戻し")])],1)],1)],1)},ye=[],Ze={name:"RequestDetail",data(){return{currentTableName:"details",data:{},title:"",created_at:"",email:"",name:"",department:"",routes:{},reason:"",date:"",contact:"",memo:"",currentStep:null,maxStep:null,latestStatus:"",latestApproverEmail:""}},computed:{...(0,k.rn)({requests:e=>e.firestore.requests,details:e=>e.firestore.details,selectedTabName:e=>e.firestore.selectedTabName}),...(0,k.Se)({getUserEmail:"firebase/getUserEmail"}),isDisabledApproveBtn(){if(this.currentStep){const e=[this.routes.approvers[this.currentStep-1].email!=this.getUserEmail,"完了"==this.routes.approvers[this.maxStep-1].status,"否認"==this.routes.approvers[this.currentStep-1].status,"差戻し"==this.routes.approvers[this.currentStep-1].status];return e.some((e=>1==e))}return!0}},methods:{...(0,k.nv)({fetchCollectionsByOneQuery:"firestore/fetchCollectionsByOneQuery",fetchMyDetail:"firestore/fetchMyDetail",fetchOthersDetail:"firestore/fetchOthersDetail",fetchRequest:"firestore/fetchRequest",batchUpdateDocuments:"firestore/batchUpdateDocuments",sendEmail:"firestore/sendEmail"}),async fetchRequestDetail(){const e=this.$route.path,t=this.getUserEmail,s=this.$route.params.id;e.startsWith("/my/")?await this.fetchMyDetail({userId:t,docId:s}):e.startsWith("/others/")&&await this.fetchOthersDetail({userId:t,docId:s}),this.data=this.details},dateToStr24HPad0(e,t){return t||(t="YYYY/MM/DD hh:mm"),t=t.replace(/YYYY/g,e.getFullYear()),t=t.replace(/MM/g,("0"+(e.getMonth()+1)).slice(-2)),t=t.replace(/DD/g,("0"+e.getDate()).slice(-2)),t=t.replace(/hh/g,("0"+e.getHours()).slice(-2)),t=t.replace(/mm/g,("0"+e.getMinutes()).slice(-2)),t=t.replace(/ss/g,("0"+e.getSeconds()).slice(-2)),t},setData(){const e=this.data.created_at.toDate(),t=this.dateToStr24HPad0(e);this.title=this.data.title,this.created_at=t,this.email=this.data.email,this.name=this.data.name,this.department=this.data.department,this.routes=this.data.routes,this.currentStep=this.data.current_step,this.maxStep=this.data.max_step,this.reason=this.data.reason,this.date=this.data.date,this.contact=this.data.contact,this.memo=this.data.memo},async onClickApprove(){const e="承認";if(this.currentStep==this.maxStep){this.routes.approvers[this.currentStep-1].status="完了",this.latestStatus=this.routes.approvers[this.currentStep-1].status,this.latestApproverEmail=null,this.batchUpdate(e);const t=this.email,s=`申請が${e}されました [${this.title}]`,a=window.location.href,r=a.replace("/others","/my"),o=this.createEmailBody(s,r),i={to:t,subject:s,body:o};await this.sendEmail({emailConfig:i})}else{this.routes.approvers[this.currentStep-1].status="完了",this.currentStep++,this.latestStatus="保留中",this.latestApproverEmail=this.routes.approvers[this.currentStep-1].email,this.batchUpdate(e);const t=this.latestApproverEmail,s=`[承認依頼] [${this.title}]`,a=window.location.href,r=this.createEmailBody(s,a),o={to:t,subject:s,body:r};await this.sendEmail({emailConfig:o})}},async onClickDisapprove(){this.routes.approvers[this.currentStep-1].status="否認",this.latestStatus="否認",this.latestApproverEmail=null;const e="否認";this.batchUpdate(e);const t=this.email,s=`申請が${e}されました [${this.title}]`,a=window.location.href,r=a.replace("/others","/my"),o=this.createEmailBody(s,r),i={to:t,subject:s,body:o};await this.sendEmail({emailConfig:i})},async onClickRemand(){this.routes.approvers[this.currentStep-1].status="差戻し",this.latestStatus="差戻し",this.latestApproverEmail=null;const e="差戻し";this.batchUpdate(e);const t=this.email,s=`申請が${e}されました [${this.title}]`,a=window.location.href,r=a.replace("/others","/my"),o=this.createEmailBody(s,r),i={to:t,subject:s,body:o};await this.sendEmail({emailConfig:i})},async batchUpdate(e){const t=this.data.email,s=this.$route.params.id;await this.fetchRequest({userId:t,docId:s});let a=this.requests;a.status=this.latestStatus,a.current_approver_email=this.latestApproverEmail;let r=this.data;r.current_step=this.currentStep,this.batchUpdateDocuments({userId:t,docId:s,itemRequest:a,itemDetail:r,operationType:e})},createEmailBody(e,t){const s=`${e}<br><br>詳細は下記リンクからご確認ください。<br><br><a href="${t}">${t}</a>`;return s}},async created(){await this.fetchRequestDetail(),this.setData()}},Te=Ze,we=(0,T.Z)(Te,ke,ye,!1,null,null,null),xe=we.exports,_e=function(){var e=this,t=e._self._c;return t("div",[t(C.Z,[t(I.EB,[t(N.Z,{attrs:{cols:"8"}},[t("div",{staticClass:"h5"},[e._v(" "+e._s(e.title)+" ")])]),t(f.Z),t(N.Z,{staticClass:"text-right",attrs:{cols:"4"}},[t(n.Z,{attrs:{dark:"",color:"green"},on:{click:e.onClickAdd}},[t(Q.Z,[e._v("mdi-plus")])],1)],1),t(N.Z,{attrs:{cols:"12"}},[t(O.Z,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),t(F.Z,{staticClass:"text-no-wrap",attrs:{headers:e.tableHeaders,items:e.tableData,search:e.search,"footer-props":e.footerProps,"sort-by":"department","sort-desc":!1,"items-per-page":30,"mobile-breakpoint":"0"},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t(Q.Z,{staticClass:"mr-2",on:{click:function(t){return e.onClickEdit(s)}}},[e._v("mdi-pencil")]),t(Q.Z,{on:{click:function(t){return e.onClickDelete(s)}}},[e._v("mdi-delete")])]}}],null,!0)})],1),t("ItemDialogDepartments",{ref:"ItemDialogDepartments"}),t("DeleteDialog",{ref:"deleteDialog"})],1)},De=[],Ce=function(){var e=this,t=e._self._c;return t(X.Z,{attrs:{scrollable:"",persistent:"","max-width":"500px",eager:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t(C.Z,[t(I.EB,[e._v(e._s(e.titleText))]),t(ee.Z),t(I.ZB,[t(P.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(O.Z,{attrs:{label:"部署",rules:e.departmentRules},model:{value:e.department,callback:function(t){e.department=t},expression:"department"}})],1)],1),t(ee.Z),t(I.h7,[t(f.Z),t(n.Z,{attrs:{color:"grey darken-1",text:""},on:{click:e.onClickClose}},[e._v(" キャンセル ")]),t(n.Z,{attrs:{color:"blue darken-1",text:"",disabled:!e.valid},on:{click:e.onClickAction}},[e._v(" "+e._s(e.actionText)+" ")])],1)],1)],1)},Ie=[],Ne={name:"ItemDialogDepartments",data(){return{currentTableName:"departments",show:!1,valid:!1,menu:!1,actionType:"add",id:"",department:"",departmentRules:[e=>e.trim().length>0||"部署は必須です",e=>e.length<=32||"32文字以内で入力してください"]}},computed:{titleText(){return"add"===this.actionType?"データ追加":"データ編集"},actionText(){return"add"===this.actionType?"追加":"更新"}},methods:{...(0,k.nv)({addDocument:"firestore/addDocument",updateDocument:"firestore/updateDocument"}),open(e,t){this.show=!0,this.actionType=e,this.resetForm(t)},onClickClose(){this.show=!1},async onClickAction(){const e={id:this.id,department:this.department},t=this.currentTableName;"add"===this.actionType?await this.addDocument({item:e,currentTableName:t}):await this.updateDocument({item:e,currentTableName:t}),this.show=!1},resetForm(e={}){this.id=e.id||"",this.department=e.department||"",this.$refs.form.resetValidation()}}},Re=Ne,Ae=(0,T.Z)(Re,Ce,Ie,!1,null,null,null),Se=Ae.exports,qe=function(){var e=this,t=e._self._c;return t(X.Z,{attrs:{persistent:"","max-width":"290"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t(C.Z,[t(I.EB),t(I.ZB,{staticClass:"black--text"},[e._v(" 削除しますか？ ")]),t(I.h7,[t(f.Z),t(n.Z,{attrs:{color:"grey",text:""},on:{click:e.onClickClose}},[e._v("キャンセル")]),t(n.Z,{attrs:{color:"red",text:""},on:{click:e.onClickDelete}},[e._v("削除")])],1)],1)],1)},Ue=[],Ee={name:"DeleteDialog",data(){return{show:!1,item:{},currentTableName:""}},methods:{...(0,k.nv)({deleteDocument:"firestore/deleteDocument"}),open(e,t){this.show=!0,this.item=e,this.currentTableName=t},onClickClose(){this.show=!1},async onClickDelete(){const e=this.item,t=this.currentTableName;await this.deleteDocument({item:e,currentTableName:t}),this.show=!1}}},$e=Ee,Pe=(0,T.Z)($e,qe,Ue,!1,null,null,null),Oe=Pe.exports,Be={name:"Departments",components:{ItemDialogDepartments:Se,DeleteDialog:Oe},data(){return{currentTableName:"departments",title:"部署一覧",search:"",tableData:[]}},computed:{...(0,k.rn)({departments:e=>e.firestore.departments}),tableHeaders(){return[{text:"部署",value:"department",sortable:!0},{text:"操作",value:"actions",sortable:!1}]},footerProps(){return{itemsPerPageText:"",itemsPerPageOptions:[30,-1]}}},methods:{...(0,k.nv)({fetchAllCollections:"firestore/fetchAllCollections"}),onClickAdd(){this.$refs.ItemDialogDepartments.open("add")},onClickEdit(e){this.$refs.ItemDialogDepartments.open("edit",e)},onClickDelete(e){const t=this.currentTableName;this.$refs.deleteDialog.open(e,t)},async getRecords(){const e=this.currentTableName;await this.fetchAllCollections({currentTableName:e}),this.tableData=this.departments}},async created(){await this.getRecords()}},Me=Be,je=(0,T.Z)(Me,_e,De,!1,null,null,null),He=je.exports,Je=function(){var e=this,t=e._self._c;return t(C.Z,[t(z.Z,{attrs:{grow:"",color:"green"}},[t(V.Z,{on:{click:function(t){return e.onClickTab("paid_leave")}}},[e._v("休暇申請")]),t(V.Z,{on:{click:function(t){return e.onClickTab("equipment")}}},[e._v("備品申請")])],1),t(I.EB,[t(N.Z,{attrs:{cols:"8"}},[t("div",{staticClass:"h5"},[e._v(" "+e._s(e.title)+" ")])]),t(f.Z),t(N.Z,{staticClass:"text-right",attrs:{cols:"4"}},[t(n.Z,{attrs:{dark:"",color:"green"},on:{click:e.onClickAdd}},[t(Q.Z,[e._v("mdi-plus")])],1)],1),t(N.Z,{attrs:{cols:"12"}},[t(O.Z,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),t(F.Z,{staticClass:"text-no-wrap",attrs:{headers:e.tableHeaders,items:e.tableData,search:e.search,"footer-props":e.footerProps,"sort-by":["department","order"],"sort-desc":[!1,!1],"items-per-page":30,"mobile-breakpoint":"0"},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t(Q.Z,{staticClass:"mr-2",on:{click:function(t){return e.onClickEdit(s)}}},[e._v("mdi-pencil")]),t(Q.Z,{on:{click:function(t){return e.onClickDelete(s)}}},[e._v("mdi-delete")])]}}],null,!0)}),t("ItemDialogRoutes",{ref:"ItemDialogRoutes"}),t("DeleteDialog",{ref:"deleteDialog"})],1)},We=[],Le=function(){var e=this,t=e._self._c;return t(X.Z,{attrs:{scrollable:"",persistent:"","max-width":"700px",eager:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t(C.Z,[t(I.EB,[e._v(e._s(e.titleText))]),t(ee.Z),t(I.ZB,[t(P.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(te.Z,{attrs:{label:"部署",rules:e.departmentRules,items:e.departments,"item-text":"department","item-value":"department"},model:{value:e.department,callback:function(t){e.department=t},expression:"department"}}),t(O.Z,{attrs:{label:"タイトル",rules:e.titleRules},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),t(O.Z,{attrs:{label:"承認者数",rules:e.numberOfApproversRules,readonly:""},model:{value:e.approvers.length,callback:function(t){e.$set(e.approvers,"length",t)},expression:"approvers.length"}}),t(F.Z,{staticClass:"text-no-wrap",attrs:{headers:e.tableHeaders,items:e.approvers,"footer-props":e.footerProps,"sort-by":["order"],"sort-desc":[!1],"items-per-page":30,"mobile-breakpoint":"0","hide-default-footer":""},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t(Q.Z,{on:{click:function(t){return e.deleteApprover(s)}}},[e._v("mdi-delete")])]}}],null,!0)}),t(te.Z,{attrs:{label:"承認者",items:e.users,"item-text":e=>`${e.name} (${e.id})`,"return-object":""},model:{value:e.userInfo,callback:function(t){e.userInfo=t},expression:"userInfo"}}),t(f.Z),t(n.Z,{attrs:{color:"blue darken-1",text:"",disabled:!e.userInfo.id},on:{click:e.addApprover}},[e._v("追加")])],1)],1),t(ee.Z),t(I.h7,[t(f.Z),t(n.Z,{attrs:{color:"grey darken-1",text:""},on:{click:e.onClickClose}},[e._v(" キャンセル ")]),t(n.Z,{attrs:{color:"blue darken-1",text:"",disabled:!e.valid},on:{click:e.onClickAction}},[e._v(" "+e._s(e.actionText)+" ")])],1)],1)],1)},Ye=[],Fe={name:"ItemDialogRoutes",data(){return{currentTableName:"routes",currentTabName:"",show:!1,valid:!1,menu:!1,actionType:"add",id:"",department:"",title:"",userInfo:"",numberOfApprovers:"",approvers:[],readers:[],departmentRules:[e=>e.trim().length>0||"部署は必須です"],titleRules:[e=>e.trim().length>0||"タイトルは必須です"],numberOfApproversRules:[e=>e>0||"承認者は必須です"]}},computed:{...(0,k.rn)({departments:e=>e.firestore.departments,users:e=>e.firestore.users}),titleText(){return"add"===this.actionType?"データ追加":"データ編集"},actionText(){return"add"===this.actionType?"追加":"更新"},tableHeaders(){return[{text:"順序",value:"order",sortable:!1},{text:"メールアドレス",value:"email",sortable:!1},{text:"氏名",value:"name",sortable:!1},{text:"操作",value:"actions",sortable:!1}]},footerProps(){return{itemsPerPageText:"",itemsPerPageOptions:[30,-1]}}},methods:{...(0,k.nv)({addDocument:"firestore/addDocument",updateDocument:"firestore/updateDocument",fetchAllCollections:"firestore/fetchAllCollections"}),open(e,t,s){this.show=!0,this.actionType=e,this.currentTabName=s,this.getDepartments(),this.getUsers(),this.resetForm(t)},onClickClose(){this.show=!1},async onClickAction(){const e={id:this.id,request_type:this.currentTabName,department:this.department,title:this.title,approvers:this.approvers},t=this.currentTableName;"add"===this.actionType?await this.addDocument({item:e,currentTableName:t}):await this.updateDocument({item:e,currentTableName:t}),this.show=!1},addApprover(){const e={order:this.approvers.length+1,email:this.userInfo.id,name:this.userInfo.name};this.approvers.push(e),this.userInfo=[]},deleteApprover(e){const t=this.approvers,s=t.indexOf(e);t.splice(s,1)},resetForm(e={}){this.id=e.id||"",this.department=e.department||"",this.title=e.title||"",this.approvers=e.approvers||[],this.readers=e.readers||[],this.$refs.form.resetValidation()},async getDepartments(){const e="departments";await this.fetchAllCollections({currentTableName:e})},async getUsers(){const e="users";await this.fetchAllCollections({currentTableName:e})}}},Qe=Fe,Ve=(0,T.Z)(Qe,Le,Ye,!1,null,null,null),ze=Ve.exports,Ge={name:"Routes",data(){return{currentTableName:"routes",title:"申請ルート設定",search:"",tableData:[],currentTabName:"paid_leave"}},components:{ItemDialogRoutes:ze,DeleteDialog:Oe},computed:{...(0,k.rn)({routes:e=>e.firestore.routes}),tableHeaders(){return[{text:"部署",value:"department",sortable:!0},{text:"タイトル",value:"title",sortable:!1},{text:"操作",value:"actions",sortable:!1}]},footerProps(){return{itemsPerPageText:"",itemsPerPageOptions:[30,-1]}}},methods:{...(0,k.nv)({fetchCollectionsByOneQuery:"firestore/fetchCollectionsByOneQuery"}),onClickTab(e){this.setCurrentTabName(e),this.getRecords()},onClickAdd(){const e=this.currentTabName;this.$refs.ItemDialogRoutes.open("add",{},e)},onClickEdit(e){const t=this.currentTabName;this.$refs.ItemDialogRoutes.open("edit",e,t)},onClickDelete(e){const t=this.currentTableName;this.$refs.deleteDialog.open(e,t)},async getRecords(){const e=this.currentTableName,t={field:"request_type",compare:"==",value:this.currentTabName};await this.fetchCollectionsByOneQuery({currentTableName:e,customQuery:t}),this.tableData=this.routes},setCurrentTabName(e){this.currentTabName=e}},created(){this.getRecords()}},Ke=Ge,Xe=(0,T.Z)(Ke,Je,We,!1,null,null,null),et=Xe.exports,tt=function(){var e=this,t=e._self._c;return t("div",[t(C.Z,[t(I.EB,[t(N.Z,{attrs:{cols:"8"}},[t("div",{staticClass:"h5"},[e._v(" "+e._s(e.title)+" ")])]),t(f.Z),t(N.Z,{staticClass:"text-right",attrs:{cols:"4"}},[t(n.Z,{attrs:{dark:"",color:"green"},on:{click:e.onClickAdd}},[t(Q.Z,[e._v("mdi-plus")])],1)],1),t(N.Z,{attrs:{cols:"12"}},[t(O.Z,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),t(F.Z,{staticClass:"text-no-wrap",attrs:{headers:e.tableHeaders,items:e.tableData,search:e.search,"footer-props":e.footerProps,"sort-by":"name","sort-desc":!1,"items-per-page":30,"mobile-breakpoint":"0"},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t(Q.Z,{on:{click:function(t){return e.onClickDelete(s)}}},[e._v("mdi-delete")])]}}],null,!0)})],1),t("ItemDialogAdmins",{ref:"ItemDialogAdmins"}),t("DeleteDialog",{ref:"deleteDialog"})],1)},st=[],at=function(){var e=this,t=e._self._c;return t(X.Z,{attrs:{scrollable:"",persistent:"","max-width":"500px",eager:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t(C.Z,[t(I.EB,[e._v(e._s(e.titleText))]),t(ee.Z),t(I.ZB,[t(P.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(te.Z,{attrs:{label:"管理者",items:e.users,"item-text":e=>`${e.name} (${e.id})`,"return-object":""},model:{value:e.userInfo,callback:function(t){e.userInfo=t},expression:"userInfo"}})],1)],1),t(ee.Z),t(I.h7,[t(f.Z),t(n.Z,{attrs:{color:"grey darken-1",text:""},on:{click:e.onClickClose}},[e._v(" キャンセル ")]),t(n.Z,{attrs:{color:"blue darken-1",text:"",disabled:!e.valid},on:{click:e.onClickAction}},[e._v(" "+e._s(e.actionText)+" ")])],1)],1)],1)},rt=[],ot={name:"ItemDialogAdmins",data(){return{currentTableName:"admins",show:!1,valid:!1,menu:!1,actionType:"add",userInfo:"",id:"",email:"",name:""}},computed:{...(0,k.rn)({users:e=>e.firestore.users}),titleText(){return"add"===this.actionType?"データ追加":"データ編集"},actionText(){return"add"===this.actionType?"追加":"更新"}},methods:{...(0,k.nv)({fetchAllCollections:"firestore/fetchAllCollections",addDocumentWithTextId:"firestore/addDocumentWithTextId",updateDocument:"firestore/updateDocument"}),open(e,t){this.show=!0,this.actionType=e,this.getUsers(),this.resetForm(t)},onClickClose(){this.show=!1},async onClickAction(){const e={id:this.userInfo.id,name:this.userInfo.name},t=this.currentTableName;"add"===this.actionType?await this.addDocumentWithTextId({item:e,currentTableName:t}):await this.updateDocument({item:e,currentTableName:t}),this.show=!1},resetForm(e={}){this.id=e.id||"",this.userInfo={name:e.name,email:e.email}||"",this.$refs.form.resetValidation()},async getUsers(){const e="users";await this.fetchAllCollections({currentTableName:e})}}},it=ot,nt=(0,T.Z)(it,at,rt,!1,null,null,null),lt=nt.exports,ct={name:"Admins",components:{ItemDialogAdmins:lt,DeleteDialog:Oe},data(){return{currentTableName:"admins",title:"管理者一覧",search:"",tableData:[]}},computed:{...(0,k.rn)({admins:e=>e.firestore.admins}),tableHeaders(){return[{text:"氏名",value:"name",sortable:!1},{text:"操作",value:"actions",sortable:!1}]},footerProps(){return{itemsPerPageText:"",itemsPerPageOptions:[30,-1]}}},methods:{...(0,k.nv)({fetchAllCollections:"firestore/fetchAllCollections"}),onClickAdd(){this.$refs.ItemDialogAdmins.open("add")},onClickEdit(e){this.$refs.ItemDialogAdmins.open("edit",e)},onClickDelete(e){const t=this.currentTableName;this.$refs.deleteDialog.open(e,t)},async getRecords(){const e=this.currentTableName;await this.fetchAllCollections({currentTableName:e}),this.tableData=this.admins}},async created(){await this.getRecords()}},ut=ct,mt=(0,T.Z)(ut,tt,st,!1,null,null,null),dt=mt.exports,ht=function(){var e=this,t=e._self._c;return t("div",[t(C.Z,[t(I.EB,[t(N.Z,{attrs:{cols:"8"}},[t("div",{staticClass:"h5"},[e._v(" "+e._s(e.title)+" ")])]),t(f.Z),t(N.Z,{staticClass:"text-right",attrs:{cols:"4"}},[t(n.Z,{attrs:{dark:"",color:"green"},on:{click:e.onClickAdd}},[t(Q.Z,[e._v("mdi-plus")])],1)],1),t(N.Z,{attrs:{cols:"12"}},[t(O.Z,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),t(F.Z,{staticClass:"text-no-wrap",attrs:{headers:e.tableHeaders,items:e.tableData,search:e.search,"footer-props":e.footerProps,"sort-by":"department","sort-desc":!1,"items-per-page":30,"mobile-breakpoint":"0"},scopedSlots:e._u([{key:"item.actions",fn:function({item:s}){return[t(Q.Z,{staticClass:"mr-2",on:{click:function(t){return e.onClickEdit(s)}}},[e._v("mdi-pencil")]),t(Q.Z,{on:{click:function(t){return e.onClickDelete(s)}}},[e._v("mdi-delete")])]}}],null,!0)})],1),t("ItemDialogUsers",{ref:"ItemDialogUsers"}),t("DeleteDialog",{ref:"deleteDialog"})],1)},pt=[],ft=function(){var e=this,t=e._self._c;return t(X.Z,{attrs:{scrollable:"",persistent:"","max-width":"500px",eager:""},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[t(C.Z,[t(I.EB,[e._v(e._s(e.titleText))]),t(ee.Z),t(I.ZB,[t(P.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(te.Z,{attrs:{label:"部署",rules:e.departmentRules,items:e.departments,"item-text":"department","item-value":"department"},model:{value:e.department,callback:function(t){e.department=t},expression:"department"}}),t(O.Z,{attrs:{label:"メールアドレス",rules:e.emailRules,readonly:"edit"==e.actionType},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),t(O.Z,{attrs:{label:"氏名",rules:e.nameRules},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),t(ee.Z),t(I.h7,[t(f.Z),t(n.Z,{attrs:{color:"grey darken-1",text:""},on:{click:e.onClickClose}},[e._v(" キャンセル ")]),t(n.Z,{attrs:{color:"blue darken-1",text:"",disabled:!e.valid},on:{click:e.onClickAction}},[e._v(" "+e._s(e.actionText)+" ")])],1)],1)],1)},bt=[],vt={name:"ItemDialogUsers",data(){return{currentTableName:"users",show:!1,valid:!1,menu:!1,actionType:"add",id:"",department:"",email:"",name:"",departmentRules:[e=>e.trim().length>0||"部署は必須です"],emailRules:[e=>e.trim().length>0||"メールアドレスは必須です",e=>e.trim().length<=32||"メールアドレスは32文字以内で入力してください"],nameRules:[e=>e.trim().length>0||"氏名は必須です",e=>e.trim().length<=32||"氏名は32文字以内で入力してください"]}},computed:{...(0,k.rn)({departments:e=>e.firestore.departments}),titleText(){return"add"===this.actionType?"データ追加":"データ編集"},actionText(){return"add"===this.actionType?"追加":"更新"}},methods:{...(0,k.nv)({addDocumentWithTextId:"firestore/addDocumentWithTextId",updateDocument:"firestore/updateDocument",fetchAllCollections:"firestore/fetchAllCollections"}),open(e,t){this.show=!0,this.actionType=e,this.getDepartments(),this.resetForm(t)},onClickClose(){this.show=!1},async onClickAction(){const e={id:this.email,department:this.department,name:this.name},t=this.currentTableName;"add"===this.actionType?await this.addDocumentWithTextId({item:e,currentTableName:t}):await this.updateDocument({item:e,currentTableName:t}),this.show=!1},resetForm(e={}){this.id=e.id||"",this.department=e.department||"",this.email=e.id||"",this.name=e.name||"",this.$refs.form.resetValidation()},async getDepartments(){const e="departments";await this.fetchAllCollections({currentTableName:e})}}},gt=vt,kt=(0,T.Z)(gt,ft,bt,!1,null,null,null),yt=kt.exports,Zt={name:"Users",components:{ItemDialogUsers:yt,DeleteDialog:Oe},data(){return{currentTableName:"users",title:"従業員一覧",search:"",tableData:[]}},computed:{...(0,k.rn)({users:e=>e.firestore.users}),tableHeaders(){return[{text:"部署",value:"department",sortable:!0},{text:"メールアドレス",value:"id",sortable:!1},{text:"氏名",value:"name",sortable:!1},{text:"操作",value:"actions",sortable:!1}]},footerProps(){return{itemsPerPageText:"",itemsPerPageOptions:[30,-1]}}},methods:{...(0,k.nv)({fetchAllCollections:"firestore/fetchAllCollections"}),onClickAdd(){this.$refs.ItemDialogUsers.open("add")},onClickEdit(e){this.$refs.ItemDialogUsers.open("edit",e)},onClickDelete(e){const t=this.currentTableName;this.$refs.deleteDialog.open(e,t)},async getRecords(){const e=this.currentTableName;await this.fetchAllCollections({currentTableName:e}),this.tableData=this.users}},created(){this.getRecords()}},Tt=Zt,wt=(0,T.Z)(Tt,ht,pt,!1,null,null,null),xt=wt.exports,_t=function(){var e=this,t=e._self._c;return t("div",[t(R.Z,[t(N.Z,{attrs:{col:"12"}},[t(C.Z,[t(I.EB,[e._v(e._s(e.title))]),t(I.ZB,[t(f.Z)],1),t(I.h7,[t(n.Z,{attrs:{dark:"",color:"green"},on:{click:e.onClickSend}},[t(Q.Z,{attrs:{left:""}},[e._v("mdi-send")]),e._v(" メール送信 ")],1)],1)],1)],1)],1)],1)},Dt=[],Ct={name:"Test",data(){return{title:"メールテスト"}},computed:{...(0,k.Se)({getUserEmail:"firebase/getUserEmail"})},methods:{...(0,k.nv)({sendEmail:"firestore/sendEmail"}),async onClickSend(){const e={to:this.getUserEmail,subject:"テストです。",body:"テスト送信です！"};await this.sendEmail({emailConfig:e})}},created(){}},It=Ct,Nt=(0,T.Z)(It,_t,Dt,!1,null,null,null),Rt=Nt.exports;a.ZP.use(_.ZP);const At=[{path:"/",name:"RequestOverview",component:pe,meta:{requiresAuth:!0}},{path:"/my/requests/:id",name:"myRequestDetail",component:xe,meta:{requiresAuth:!0}},{path:"/others/requests/:id",name:"othersRequestDetail",component:xe,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:$,beforeEnter(e,t,s){const a=(0,D.v0)();(0,D.Aj)(a,(e=>{e?s("/"):s()}))}},{path:"/settings",name:"Settings",component:W,meta:{requiresAuth:!0}},{path:"/departments",name:"Departments",component:He,meta:{requiresAuth:!0}},{path:"/routes",name:"Routes",component:et,meta:{requiresAuth:!0}},{path:"/admins",name:"Admins",component:dt,meta:{requiresAuth:!0}},{path:"/users",name:"Users",component:xt,meta:{requiresAuth:!0}},{path:"/test",name:"Test",component:Rt,meta:{requiresAuth:!0}}],St=new _.ZP({mode:"history",routes:At});St.beforeEach(((e,t,s)=>{const a=e.matched.some((e=>e.meta.requiresAuth));if(a){const t=(0,D.v0)();(0,D.Aj)(t,(t=>{t?s():s({path:"/login",query:{redirect:e.fullPath}})}))}else s()}));var qt=St,Ut=s(9669),Et=s.n(Ut);const $t=Et().create({headers:{"content-type":"text/plain"}});$t.interceptors.response.use((e=>e.data.error?Promise.reject(e.data.error):Promise.resolve(e)),(e=>Promise.reject(e)));let Pt="";const Ot=e=>{Pt=e};let Bt="";const Mt=e=>{Bt=e},jt=e=>$t.post(Pt,{method:"POST",authToken:Bt,params:{emailConfig:e}});var Ht={setUrl:Ot,setAuthToken:Mt,sendEmail:jt};const Jt={settings:{appName:"ワークフロー",apiUrl:"",authToken:""}},Wt={saveSettings(e,{settings:t}){e.settings={...t};const{appName:s,apiUrl:a,authToken:r}=e.settings;document.title=s,Ht.setUrl(a),Ht.setAuthToken(r),localStorage.setItem("settings",JSON.stringify(t))},loadSettings(e){const t=JSON.parse(localStorage.getItem("settings"));t&&(e.settings=Object.assign(e.settings,t));const{appName:s,apiUrl:a,authToken:r}=e.settings;document.title=s,Ht.setUrl(a),Ht.setAuthToken(r)}},Lt={saveSettings({commit:e},{settings:t}){e("saveSettings",{settings:t})},loadSettings({commit:e}){e("loadSettings")}},Yt={};var Ft={namespaced:!0,state:Jt,mutations:Wt,actions:Lt,getters:Yt};const Qt={loggedIn:!1,userUid:"",userName:"",userIcon:"",userEmail:"",authMessage:""},Vt={setLoginStatus(e,t){e.loggedIn=t},setUserUid(e,t){e.userUid=t},setUserName(e,t){e.userName=t},setUserIcon(e,t){e.userIcon=t},setUserEmail(e,t){e.userEmail=t},setAuthMessage(e,t){e.authMessage=t}},zt={async login({commit:e}){console.log("login action");const t=new D.hJ,s=(0,D.v0)();await(0,D.rh)(s,t).then((t=>{const s=t.user;e("setUserUid",s.uid),e("setUserName",s.displayName),e("setUserIcon",s.photoURL),e("setUserEmail",s.email),e("setAuthMessage","ログインしました。"),console.log("login success")})).catch((e=>{const t=e.code,s=e.message;console.log("login error: ",t,s)})),await(0,D.Fb)(s,D.a$).then((()=>{console.log("keeping state")})).catch((e=>{const t=e.code,s=e.message;console.log("keeping state error: ",t,s)}))},logout({commit:e}){const t=(0,D.v0)();(0,D.w7)(t).then((()=>{e("setAuthMessage","ログアウトしました。"),console.log("logout success"),e("setLoginStatus",!1)})).catch((e=>{console.log("logout error",e)}))},onAuth({commit:e}){const t=(0,D.v0)();(0,D.Aj)(t,(t=>{t=t||{},e("setUserUid",t.uid),e("setUserName",t.displayName),e("setLoginStatus",!!t.uid),e("setUserIcon",t.photoURL),e("setUserEmail",t.email),console.log("onAuth")}))}},Gt={getLoginStatus(e){return e.loggedIn},getUserUid(e){return e.userUid},getUserName(e){return e.userName},getUserIcon(e){return e.userIcon},getUserEmail(e){return e.userEmail}};var Kt={namespaced:!0,state:Qt,mutations:Vt,actions:zt,getters:Gt},Xt=s(5503),es=s(6257);const ts={apiKey:"AIzaSyCheZvfsN7MBNDc2gAPcwbH9uXREw8vlJo",authDomain:"vue-gas-workflow-auth.firebaseapp.com",projectId:"vue-gas-workflow-auth",storageBucket:"vue-gas-workflow-auth.appspot.com",messagingSenderId:"1046023525328",appId:"1:1046023525328:web:b7e1344c644108f2ccdfd5"},ss=(0,Xt.ZF)(ts),as=(0,es.ad)(ss);var rs=as;const os={workflowMessage:"",requests:[],myRequests:[],othersRequests:[],details:[],users:[],departments:[],routes:[],admins:[],userInfo:"",arrayRoute:[],selectedTabName:""},is={setWorkflowMessage(e,t){e.workflowMessage=t},setCollections(e,{collections:t,currentTableName:s}){e[s]=t},addDocument(e,{item:t,currentTableName:s}){const a=e[s];a.push(t)},updateDocument(e,{item:t,currentTableName:s}){const a=e[s],r=a.findIndex((e=>e.id===t.id));a.splice(r,1,t)},deleteDocument(e,{id:t,currentTableName:s}){const a=e[s],r=a.findIndex((e=>e.id===t));a.splice(r,1)},setUserInfo(e,{userInfo:t}){e.userInfo=t},setArrayRoute(e,{route:t}){e.arrayRoute=t},setSelectedTabName(e,{selectedTabName:t}){e.selectedTabName=t}},ns={async fetchAllCollections({commit:e},{currentTableName:t}){const s=(0,es.IO)((0,es.hJ)(rs,t)),a=await(0,es.PL)(s),r=[];a.forEach((e=>{r.push({...e.data(),id:e.id})})),e("setCollections",{collections:r,currentTableName:t})},async addDocument({commit:e},{item:t,currentTableName:s}){const a=(0,es.hJ)(rs,s),r=await(0,es.ET)(a,t),o=await(0,es.QT)(r),i={...o.data(),id:o.id};e("addDocument",{item:i,currentTableName:s}),e("setWorkflowMessage","データを追加しました。")},async addDocumentWithTextId({commit:e},{item:t,currentTableName:s}){const a=(0,es.JU)(rs,s,t.id);await(0,es.pl)(a,t);const r=await(0,es.QT)(a),o=r.data();e("addDocument",{item:o,currentTableName:s})},async updateDocument({commit:e},{item:t,currentTableName:s}){const a=(0,es.JU)(rs,s,t.id);await(0,es.r7)(a,t),e("updateDocument",{item:t,currentTableName:s}),e("setWorkflowMessage","データを更新しました。")},async deleteDocument({commit:e},{item:t,currentTableName:s}){const a=t.id,r=(0,es.JU)(rs,s,t.id);await(0,es.oe)(r,t),e("deleteDocument",{id:a,currentTableName:s}),e("setWorkflowMessage","データを削除しました。")},async fetchCollectionsByOneQuery({commit:e},{currentTableName:t,customQuery:s}){const a=(0,es.IO)((0,es.hJ)(rs,t),(0,es.ar)(s.field,s.compare,s.value)),r=await(0,es.PL)(a),o=[];r.forEach((e=>{o.push({...e.data(),id:e.id})})),e("setCollections",{collections:o,currentTableName:t})},async fetchCollectionByDocId({commit:e},{currentTableName:t,docId:s}){const a=(0,es.JU)(rs,t,s),r=await(0,es.QT)(a),o={...r.data(),id:r.id};e("setCollections",{collections:o,currentTableName:t})},async fetchMyDetail({commit:e},{userId:t,docId:s}){const a=(0,es.JU)(rs,"users",t,"requests",s,"details",s),r=await(0,es.QT)(a),o=r.data();e("setCollections",{collections:o,currentTableName:"details"})},async fetchOthersDetail({commit:e},{userId:t,docId:s}){const a=(0,es.IO)((0,es.B$)(rs,"details"),(0,es.ar)("id","==",s),(0,es.ar)("current_approver_email","==",t)),r=await(0,es.PL)(a),o=[];r.forEach((e=>{o.push({...e.data(),id:e.id})}));const i=o[0];e("setCollections",{collections:i,currentTableName:"details"})},async fetchRequest({commit:e},{userId:t,docId:s}){const a=(0,es.JU)(rs,"users",t,"requests",s),r=await(0,es.QT)(a),o=r.data();e("setCollections",{collections:o,currentTableName:"requests"})},async fetchMyRequests({commit:e},{userId:t}){const s=(0,es.hJ)(rs,"users",t,"requests"),a=await(0,es.PL)(s),r=[];a.forEach((e=>{r.push({...e.data(),id:e.id})})),e("setCollections",{collections:r,currentTableName:"myRequests"})},async fetchOthersRequests({commit:e},{userId:t}){const s=(0,es.IO)((0,es.B$)(rs,"requests"),(0,es.ar)("current_approver_email","==",t)),a=await(0,es.PL)(s),r=[];a.forEach((e=>{r.push({...e.data(),id:e.id})})),e("setCollections",{collections:r,currentTableName:"othersRequests"})},async batchAddSubCollectionsToUsers({commit:e},{uid:t,userId:s,item:a}){const r=(0,es.qs)(rs),o=(0,es.JU)(rs,"users",s,"requests",t),i=(0,es.JU)(rs,"users",s,"requests",t,"details",t);r.set(o,a.request),r.set(i,a.detail),await r.commit();const n=await(0,es.QT)(o),l={...n.data(),id:t};e("addDocument",{item:l,currentTableName:"myRequests"}),e("setWorkflowMessage","申請を提出しました。")},async batchUpdateDocuments({commit:e},{userId:t,docId:s,itemRequest:a,itemDetail:r,operationType:o}){const i=(0,es.qs)(rs),n=(0,es.JU)(rs,"users",t,"requests",s),l=(0,es.JU)(rs,"users",t,"requests",s,"details",s);i.set(n,a),i.set(l,r),await i.commit(),e("setCollections",{collections:a,currentTableName:"requests"}),e("setWorkflowMessage",`申請を${o}しました。`)},async fetchUserInfo({commit:e},{userId:t}){const s=await(0,es.QT)((0,es.JU)(rs,"users",t)),a=s.data();e("setUserInfo",{userInfo:a})},async createArrayRoute({commit:e},{requestType:t,department:s}){const a=await ls(t,s);e("setArrayRoute",{route:a})},setSelectedTabName({commit:e},{selectedTabName:t}){e("setSelectedTabName",{selectedTabName:t})},async sendEmail({commit:e},{emailConfig:t}){await Ht.sendEmail(t),e("setWorkflowMessage","メール送信しました。")}};async function ls(e,t){const s="routes",a=(0,es.IO)((0,es.hJ)(rs,s),(0,es.ar)("request_type","==",e),(0,es.ar)("department","==",t)),r=await(0,es.PL)(a),o=[];return r.forEach((e=>{o.push({...e.data(),id:e.id})})),o}const cs={getArrayRoute(e){return e.arrayRoute}};var us={namespaced:!0,state:os,mutations:is,actions:ns,getters:cs};a.ZP.use(k.ZP);var ms=new k.ZP.Store({modules:{workflow:Ft,firebase:Kt,firestore:us}}),ds=s(1705);a.ZP.use(ds.Z);var hs=new ds.Z({});a.ZP.config.productionTip=!1;const ps=async()=>{await ms.dispatch("firebase/onAuth"),new a.ZP({router:qt,store:ms,vuetify:hs,render:e=>e(x)}).$mount("#app")};ps()}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,s),o.exports}s.m=e,function(){var e=[];s.O=function(t,a,r,o){if(!a){var i=1/0;for(u=0;u<e.length;u++){a=e[u][0],r=e[u][1],o=e[u][2];for(var n=!0,l=0;l<a.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((function(e){return s.O[e](a[l])}))?a.splice(l--,1):(n=!1,o<i&&(i=o));if(n){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,r,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,o,i=a[0],n=a[1],l=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in n)s.o(n,r)&&(s.m[r]=n[r]);if(l)var u=l(s)}for(t&&t(a);c<i.length;c++)o=i[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},a=self["webpackChunkvue_gas_workflow"]=self["webpackChunkvue_gas_workflow"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(7506)}));a=s.O(a)})();